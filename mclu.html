<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Medium is the Message</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        :root {
            --bg-color: #F0EEE6; /* Cream */
            --text-color: #333333; /* Slate */
            --font-mono: 'ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', 'Liberation Mono', 'Courier New', monospace;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-mono);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            right: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
            pointer-events: none;
        }

        .content-overlay {
            position: relative;
            z-index: 2;
            width: 100%;
            pointer-events: none;
        }

        .scroll-column {
            width: 45%;
            min-width: 320px;
            padding: 10vh 5vw;
            pointer-events: auto;
        }

        section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            opacity: 0.1;
            transform: translateX(-20px);
            transition: all 1.2s cubic-bezier(0.16, 1, 0.3, 1);
            margin-bottom: 20vh;
        }

        section.active {
            opacity: 1;
            transform: translateX(0);
        }

        h1 {
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--text-color);
            display: inline-block;
            padding-bottom: 10px;
        }

        p {
            font-size: 1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
            max-width: 40ch;
        }

        .quote {
            padding-left: 1.5rem;
            border-left: 1px solid var(--text-color);
            font-style: italic;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 2px;
            background: var(--text-color);
            z-index: 100;
            width: 0%;
        }

        @media (max-width: 768px) {
            .scroll-column { width: 90%; background: rgba(240, 238, 230, 0.8); }
            section { min-height: 80vh; }
        }
    </style>
</head>
<body>

    <div class="progress-bar" id="progressBar"></div>
    <div id="canvas-container"></div>

    <div class="content-overlay">
        <div class="scroll-column">
            <section id="stage-0">
                <h1>01 // MECHANICAL</h1>
                <p class="quote">"The medium is the message."</p>
                <p>In a culture like ours, long accustomed to splitting and dividing all things as a means of control, it is sometimes a shock to be reminded that, in operational and practical fact, the medium is the message.</p>
                <p>The railway introduced a change of scale, pace, and pattern into human affairs. It did not matter what the train carried; the message was the transformation of the city itself.</p>
            </section>

            <section id="stage-1">
                <h1>02 // ELECTRIC</h1>
                <p>The electric light is pure information. It is a medium without a content, unless it is used to spell out some verbal ad or name.</p>
                <p>When the sequence of the mechanical gives way to the simultaneity of the electric, the grid shatters. We are thrust into a field of instant information where the "content" is merely a distraction for the watchdog of the mind.</p>
            </section>

            <section id="stage-2">
                <h1>03 // CUBIST</h1>
                <p class="quote">"Cubism... drops the illusion of perspective in favor of instant sensory awareness of the whole."</p>
                <p>By giving us the inside and outside, the top and bottom simultaneously, Cubism announced that the medium is the message. It is a world of total involvement, where specialized segments are replaced by the total field.</p>
            </section>

            <section id="stage-3">
                <h1>04 // THE ICON</h1>
                <p>We live in the Narcissus Narcosis. We are numb to our own technological extensions. To wake up is to recognize the pattern of the inclusive form.</p>
                <p>The Icon is not a picture; it is an image that demands participation. It pulses with the rhythm of the total environment. The medium has become the message.</p>
            </section>
        </div>
    </div>

    <script>
        let scene, camera, renderer, clock;
        let points, gridLines, iconMesh;
        let scrollProgress = 0;
        const lerp = (a, b, t) => a + (b - a) * t;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 10;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            clock = new THREE.Clock();

            createGeometries();
            setupScroll();
            animate();

            window.addEventListener('resize', onWindowResize);
        }

        function createGeometries() {
            const count = 2000;
            const pos = new Float32Array(count * 3);
            const targets = new Float32Array(count * 3);

            // Setup points
            for (let i = 0; i < count; i++) {
                const i3 = i * 3;
                pos[i3] = (Math.random() - 0.5) * 15;
                pos[i3+1] = (Math.random() - 0.5) * 15;
                pos[i3+2] = (Math.random() - 0.5) * 15;
            }

            const geometry = new THREE.BufferGeometry();
            geometry.setAttribute('position', new THREE.BufferAttribute(pos, 3));
            
            const material = new THREE.PointsMaterial({
                color: 0x333333,
                size: 0.04,
                transparent: true,
                opacity: 0.8
            });

            points = new THREE.Points(geometry, material);
            scene.add(points);

            // Mechanical Grid (Line Segments)
            const gridGeom = new THREE.BufferGeometry();
            const gridPos = [];
            for(let x = -5; x <= 5; x++) {
                gridPos.push(x, -5, 0, x, 5, 0);
                gridPos.push(-5, x, 0, 5, x, 0);
            }
            gridGeom.setAttribute('position', new THREE.Float32BufferAttribute(gridPos, 3));
            gridLines = new THREE.LineSegments(gridGeom, new THREE.LineBasicMaterial({ color: 0x333333, transparent: true, opacity: 0.2 }));
            scene.add(gridLines);

            // The Icon (Icosahedron)
            const iconGeom = new THREE.IcosahedronGeometry(3, 1);
            const iconMat = new THREE.MeshBasicMaterial({ 
                color: 0x333333, 
                wireframe: true, 
                transparent: true, 
                opacity: 0 
            });
            iconMesh = new THREE.Mesh(iconGeom, iconMat);
            scene.add(iconMesh);
        }

        function setupScroll() {
            window.addEventListener('scroll', () => {
                const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                scrollProgress = winScroll / height;
                
                document.getElementById('progressBar').style.width = (scrollProgress * 100) + '%';

                // Update active sections
                document.querySelectorAll('section').forEach((s, i) => {
                    const rect = s.getBoundingClientRect();
                    if (rect.top < window.innerHeight * 0.7 && rect.bottom > window.innerHeight * 0.3) {
                        s.classList.add('active');
                    } else {
                        s.classList.remove('active');
                    }
                });
            });
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();
            const positions = points.geometry.attributes.position.array;
            
            // Camera Sway
            camera.position.x = Math.sin(time * 0.5) * 0.5;
            camera.position.y = Math.cos(time * 0.5) * 0.5;
            camera.lookAt(0, 0, 0);

            // Transformation Logic (Wu Wei)
            for (let i = 0; i < positions.length / 3; i++) {
                const i3 = i * 3;
                let tx, ty, tz;

                if (scrollProgress < 0.25) {
                    // STAGE 1: Linear Sequence
                    const p = scrollProgress / 0.25;
                    tx = (Math.floor(i / 40) - 25) * 0.4;
                    ty = ((i % 40) - 20) * 0.4;
                    tz = Math.sin(i * 0.1 + time) * 0.2;
                    gridLines.material.opacity = lerp(0.2, 0.4, p);
                    points.material.opacity = 0.5;
                } 
                else if (scrollProgress < 0.5) {
                    // STAGE 2: Shattering
                    const p = (scrollProgress - 0.25) / 0.25;
                    tx = (Math.random() - 0.5) * 20 * p;
                    ty = (Math.random() - 0.5) * 20 * p;
                    tz = (Math.random() - 0.5) * 20 * p;
                    gridLines.material.opacity = lerp(0.2, 0, p);
                } 
                else if (scrollProgress < 0.75) {
                    // STAGE 3: Cubist Form
                    const p = (scrollProgress - 0.5) / 0.25;
                    const phi = Math.acos(-1 + (2 * i) / (positions.length/3));
                    const theta = Math.sqrt((positions.length/3) * Math.PI) * phi;
                    tx = 3.5 * Math.cos(theta) * Math.sin(phi);
                    ty = 3.5 * Math.sin(theta) * Math.sin(phi);
                    tz = 3.5 * Math.cos(phi);
                    iconMesh.material.opacity = lerp(0, 0.3, p);
                } 
                else {
                    // STAGE 4: The Icon (Pulse)
                    const p = (scrollProgress - 0.75) / 0.25;
                    const pulse = 1 + Math.sin(time * 2) * 0.2;
                    const phi = Math.acos(-1 + (2 * i) / (positions.length/3));
                    const theta = Math.sqrt((positions.length/3) * Math.PI) * phi;
                    tx = 3.5 * pulse * Math.cos(theta) * Math.sin(phi);
                    ty = 3.5 * pulse * Math.sin(theta) * Math.sin(phi);
                    tz = 3.5 * pulse * Math.cos(phi);
                    iconMesh.scale.set(pulse, pulse, pulse);
                    iconMesh.material.opacity = 0.5;
                }

                // Smooth Lerp positions for fluidity
                positions[i3] += (tx - positions[i3]) * 0.08;
                positions[i3+1] += (ty - positions[i3+1]) * 0.08;
                positions[i3+2] += (tz - positions[i3+2]) * 0.08;
            }

            points.geometry.attributes.position.needsUpdate = true;
            points.rotation.y += 0.002;
            iconMesh.rotation.y -= 0.005;

            renderer.render(scene, camera);
        }

        window.onload = init;
    </script>
</body>
</html>